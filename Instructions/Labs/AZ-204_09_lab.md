---
lab:
    title: '랩: Logic Apps로 비즈니스 프로세스 자동화'
    az204Module: '모듈 09: App Service Logic Apps 개발'
---
    
# 랩: Logic Apps로 비즈니스 프로세스 자동화
# 학생 랩 매뉴얼

## 랩 시나리오

조직은 Microsoft Azure의 SMB(서버 메시지 블록) 파일 공유에서 타사 제품을 구성하는 데 사용하는 JSON 파일 컬렉션을 유지합니다. 정기적인 감사 연습의 일환으로 운영 팀은 간단한 HTTP 엔드포인트를 호출하고 구성 파일의 현재 목록을 검색하고자 합니다. 귀하께서는 Azure API Management 서비스 및 Logic Apps를 기반으로 코드가 없는 솔루션을 사용하여 이 기능을 구현하기로 결정했습니다.

## 목적

이 랩을 완료하면 다음 작업을 할 수 있습니다.

-   논리 앱 워크플로를 만듭니다.

-   논리 앱에서 제품 및 API를 관리합니다.

-   Azure API API Management를 논리 앱의 프록시로 사용합니다.

## 랩 설정

-   예상 시간: **45분**

## 지침

### 시작하기 전에

#### 랩 가상 머신에 로그인

다음 자격 증명을 사용하여 Windows 10 VM(가상 머신)에 로그인해야 합니다.
    
-   사용자 이름: **Admin**

-   암호: **Pa55w.rd**

#### 설치된 응용 프로그램 리뷰

Windows 10 데스크톱에서 작업 표시줄을 찾습니다. 작업 표시줄에는 이 랩에서 사용할 애플리케이션에 대한 아이콘이 포함되어 있습니다.

-   Microsoft Edge

-   파일 탐색기

-   Windows Terminal

### 연습 1: Azure 리소스 만들기

#### 작업 1: Azure Portal 열기

1.  Azure Portal(<https://portal.azure.com>)에 로그인합니다.

1.  Azure Portal에 처음 로그인하는 경우 포털 둘러보기를 제공하는 대화 상자가 표시됩니다. 둘러보기를 건너뛰려면 **시작하기**를 선택합니다.

#### 작업 2: API Management 리소스 만들기

1.  Azure Portal에서 다음과 같은 세부 정보를 사용하여 새 API Management 계정을 만듭니다.

    -   새 리소스 그룹: **AutomatedWorkflow**

    -   이름: **prodapim[yourname]**

    -   위치: **미국 동부**

    -   조직 이름: **Contoso**

    -   가격 책정 계층: **사용(99.9 SLA, %)**

    > **참고**: 랩을 진행하기 전에 Azure가 API Management 리소스 만들기를 완료할 때까지 기다립니다. 리소스가 생성되면 알림을 받게 됩니다.

#### 작업 3: 논리 앱 리소스 만들기

1.  Azure Portal에서 다음과 같은 세부 정보를 사용하여 새 **논리 앱**을 만듭니다.
    
    -   기존 리소스 그룹: **AutomatedWorkflow**

    -   이름: **prodflow*[yourname]***

    -   위치: **지역 - 미국 동부**

    -   Log Analytics: **꺼짐**

    > **참고**: 랩으로 진행하기 전에 Azure가 Logic Apps 리소스 만들기를 완료할 때까지 기다립니다. 리소스가 만들어지면 알림이 표시됩니다.

#### 작업 4: 스토리지 계정 만들기

1.  다음 세부 정보를 사용하여 새 스토리지 계정을 만듭니다.
    
    -   기존 리소스 그룹: **AutomatedWorkflow**

    -   이름: **prodstor*[yourname]***

    -   위치: **(미국) 미국 동부**

    -   성능: **표준**

    -   계정 종류: **StorageV2(범용 v2)**

    -   복제: **LRS(로컬 중복 스토리지)**

    -   액세스 계층: **핫**

    > **참고**: 랩을 이동시키기 전에 Azure 에서 스토리지 계정 만들기가 완료될 때까지 기다립니다. 계정이 생성되면 알림을 받게 됩니다.

#### 작업 5: Azure Files에 샘플 콘텐츠 업로드

1.  이전에 랩에서 만든 **prodstor*[yourname]*** 스토리지 계정에 액세스합니다.

1.  **파일 서비스**섹션에서 **파일 공유** 링크를 선택한 다음 다음 설정을 사용하여 새 공유를 만듭니다.
    
    - 이름 : **메타 데이터**

    - 할당량: **1** GiB 

1.  최근에 만든 **메타데이터**공유를 선택합니다.
    
1.  **메타데이터** 공유에서 **업로드**를 선택하여 **Allfiles (F):** 에 다음 파일을 업로드합니다.랩 VM의 **\\Allfiles\\Labs\\09\\Starter** 폴더.

    -   **item_00.json**
    
    -   **item_01.json**
    
    -   **item_02.json**
    
    -   **item_03.json**
    
    -   **item_04.json** 

    > **참고**: **파일이 이미 있는 경우 덮어쓰기** 옵션을 사용하도록 설정하는 것이 좋습니다.

#### 검토

이 연습에서는 이 랩에 사용할 모든 리소스를 만들었습니다.

### 연습 2: Logic Apps를 사용하여 워크플로 구현

#### 작업 1: 워크플로에 대한 트리거 만들기

1.  이 랩의 앞에서 만든 **prodflow*[yourname]*** 논리 앱에 액세스합니다.

1.  **Logic Apps 디자이너** 블레이드에서 **빈 논리 앱** 템플릿을 선택합니다.

1.  **디자이너** 영역에서 새 HTTP **요청이 수신되면 (요청)** 트리거를 다음과 같은 세부 정보로  추가합니다.

    -   메서드: **GET**

#### 작업 2: Azure Storage 파일 공유를 쿼리하는 작업 만들기

1.  **디자이너** 영역에서 새 **파일 나열(Azure 파일 스토리지)** 작업을 다음과 같은 세부 정보와 함께 추가합니다.

    -   연결 이름: **filesConnection**

    -   스토리지 계정: **prodstor*[yourname]***
    
    -   폴더: **/metadata**
    
#### 작업 3: 프로젝트 목록 항목 속성에 대한 작업 만들기

1.  **디자이너** 영역에서 다음과 같은 세부 정보와 함께 새 **선택 (데이터 작업)** 을 추가합니다.

    -   From: **값(파일 나열)**

    -   매핑 모드: **텍스트**

    -   매핑: **이름(파일 나열)**

#### 작업 4: HTTP 응답 작업 빌드

1.  **디자이너** 영역에서 다음과 같은 세부 정보와 함께 새 **응답 (요청)** 작업을 추가합니다.
    
    -   상태 코드: **200**
    
    -   본문: **출력(선택)**

1.  워크플로를 **저장**합니다.

#### 검토

이 연습에서는 HTTP GET 요청에 의해 트리거될 때 시작하는 기본 워크플로를 구축했습니다. 그런 다음 스토리지 서비스를 쿼리하고 결과를 열거한 다음 해당 결과를 HTTP 응답으로 반환합니다.

### 연습 3: Azure API Management를 Logic Apps의 프록시로 사용

#### 작업 1: 새 제품 만들기

1.  이전에 랩에서 만든 **prodapim*[yourname]*** API 관리 리소스에 액세스합니다.

1.  새 계정에 대한 **상품**의 빈 목록으로 이동합니다.

    > **참고**: 소비 계정은 제품 없이 시작됩니다.

1.  다음 정보를 사용하여 새 제품을 추가합니다.

    -   표시 이름: **무료**

    -   ID:**무료** 

    -   설명: **익명 사용을 위한 무료 계층**

    -   상태: **게시됨**

    -   구독 필요: **거짓**

#### 작업 2: Logic Apps와 통합된 API 만들기

1.  계정의 **API** 빈 목록으로 이동합니다.

1.  다음 세부 정보를 사용하여 새 **논리 앱** 통합 API를 만듭니다.

    -   논리 앱: **prodflow*[yourname]***
    
    -   표시 이름: **메타데이터 조회**

    -   이름: **metadata-lookup**

    -   설명: **메타데이터 JSON 파일 조회**

    -   제품: **무료**

#### 작업 3: API 작업 테스트

1.  새 API용 **테스트** 탭으로 이동합니다.

1.  **테스트** 탭에서 다음 작업을 수행합니다.

    1.  단일 **GET** 작업을 선택합니다.

    1.  **URL 요청** 필드의 값을 복사합니다. (이 값은 랩에서 나중에 사용합니다.)

    1.  작업에 대해 테스트 요청을 합니다.

    1.  테스트 요청의 JSON 결과를 관찰합니다.

#### 작업 4: httprepl을 사용하여 종단 간 솔루션 유효성을 검사합니다.

1.  **Window 터미널** 애플리케이션을 엽니다.

1.  **httprepl** 도구를 시작하고 다음 예제를 사용하여 이 랩의 앞에서 복사한 API 작업에 대한 **요청 URL** 값으로 URI(Uniform Resource Identifier)를 설정합니다.

    ```
    httprepl <api-operation-request-url>
    ```

    > **참고**: 예를 들어 **URL**이 **https://prodapimstudent.azure-api.net/manual/paths/invoke** 인 경우, 명령은 **httprepl https://prodapimstudent.azure-api.net/manual/paths/invoke** 가 됩니다.

1.  httprepl 도구가 표시하는 오류 메시지를 살펴봅니다. 이 메시지는 도구가 API를 "통과"하는 데 사용할 Swagger 정의 파일을 검색하기 때문에 발생합니다. 논리 앱은 Swagger 정의 파일을 생성하지 않으므로 API를 수동으로 통과해야 합니다.

1.  도구 프롬프트 내에서 API 엔드포인트에 대해 **GET** 명령을 실행합니다.

    ```
    get
    ```

1.  JSON 응답 내용을 관찰합니다.

1.  **httprepl** 애플리케이션을 종료합니다.

    ```
    exit
    ```

1.  현재 실행 중인 Microsoft Terminal 애플리케이션을 닫습니다.

1.	Azure Portal 내 브라우저 창으로 돌아갑니다.

#### 검토

이 연습에서는 Azure API Management를 프록시로 사용하여 논리 앱 워크플로를 트리거했습니다.

### 연습 4: 구독 정리

#### 작업 1: Azure Cloud Shell 열기 및 리소스 그룹 나열

1.  Azure Portal에서 **Cloud Shell** 아이콘을 선택하여 새 셸 인스턴스를 엽니다.

1.  Cloud Shell이 아직 구성되지 않은 경우 기본 설정을 사용하여 Bash 셸을 구성합니다.

#### 작업 2: 리소스 그룹 삭제

1.  다음 명령을 입력하고 엔터를 선택하여 **AutomatedWorkflow** 리소스 그룹을 삭제합니다.

    ```
    az group delete --name AutomatedWorkflow --no-wait --yes
    ```

1.  Cloud Shell 창을 닫습니다.

#### 작업 3: 활성 애플리케이션 닫기

-   현재 실행 중인 Microsoft Edge 애플리케이션을 닫습니다.

#### 검토

이 연습에서는 이 랩에 사용된 리소스 그룹을 제거하여 구독을 정리했습니다.
